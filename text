apt-mark unhold kubeadm && \
apt-get update && apt-get install -y kubeadm='1.31.1-1.1' && \
apt-mark hold kubeadm



export KUBECONFIG=/etc/kubernetes/admin.conf
kubectl drain k8s-worker-node-03.internal.locthp.com  --ignore-daemonsets --delete-emptydir-data
apt-mark unhold kubelet kubectl && \
apt-get update && apt-get install -y kubelet='1.31.1-1.1' kubectl='1.31.1-1.1' && \
apt-mark hold kubelet kubectl 
systemctl daemon-reload 
systemctl restart kubelet
kubectl uncordon k8s-worker-node-03.internal.locthp.com 


version: '3.8'
services:
  mysql:
    image: mysql:8.3
    restart: unless-stopped
    ports:
      - "3306:3306"
    environment:
      MYSQL_ROOT_PASSWORD: root
      MYSQL_DATABASE: chat_app
    volumes:
      - ./db-creation.sql:/docker-entrypoint-initdb.d/script.sql
  socket:
    pull_policy: always
    restart: unless-stopped
    image: locthp/socket_service:dev
    ports:
      - "8000:8000"
networks:
  chat_app:
    name: chat_app
    driver: bridge


external-dns.alpha.kubernetes.io/target: "172.16.1.199"
external-dns.alpha.kubernetes.io/hostname: "longhorn.internal.locthp.com"

helm upgrade --install ingress-nginx ingress-nginx \
  --repo https://kubernetes.github.io/ingress-nginx \
  --namespace ingress-nginx --create-namespace -f ingress-values.yml